@using Microsoft.Extensions.Localization
@using Blogifier.Shared.Resources
@using Blogifier.Shared
@inject IStringLocalizer<Resource> _localizer

@{
    Layout = "~/Views/Themes/Standard/shared/layout/_layout.cshtml";
    ListModel listModel = (ListModel)Model;
    Pager pgr = listModel.Pager;
    string root = Url.Content("~/");
    string cover = $"{root}{listModel.Blog.Cover}";
    var catUrl = Url.Content("~/categories");
    string theme = listModel.Blog.Theme;
}

@if (listModel.Posts.Count() > 0)
{
        @foreach (var post in listModel.Posts)
        {
            <article class="mb-5 shadow-lg">
                <figure class="mb-0">
                    <a href="posts/@post.Slug">
                        <img src="~/@post.Cover" class="w-100" onerror="this.onerror=null;this.src='@root@post.Cover';" alt="@post.Title">
                    </a>
                </figure>
                <section class="p-5">
                    <header class="post-header">
                        <div class="text-muted mb-3">
                            <time>@post.Published.ToFriendlyDateString()</time>
                            <span>
                                @if (post.Categories != null && post.Categories.Count > 0)
                                {
                                    <span>/</span>
                                    foreach (var cat in post.Categories)
                                    {
                                        <a class="text-muted" href="@catUrl/@cat">@cat</a>
                                    }
                                }
                            </span>
                        </div>
                        <h2 class="post-title"><a class="post-title-link" href="posts/@post.Slug">@post.Title</a></h2>
                    </header>
                    <div class="post-body">
                        <p>
                            @Html.Raw(post.Description)
                        </p>
                        <a class="post-more" href="posts/@post.Slug">Read More</a>
                    </div>
                    @if (post.Featured)
                    {
                        <span class="post-label">@_localizer["featured"]</span>
                    }
                </section>
            </article>
        }

    @if (pgr != null && (pgr.ShowOlder || pgr.ShowNewer))
    {
        <ul class="pagination justify-content-center mt-5">
            @if (pgr.ShowOlder)
            {
                <li class="item item-prev">
                    <a class="item-link" href="@pgr.LinkToOlder">
                        <i class="item-icon fa fa-angle-left"></i>
                    </a>
                </li>
            }
            @if (pgr.ShowNewer)
            {
                <li class="item item-next">
                    <a class="item-link" href="@pgr.LinkToNewer">
                        <i class="item-icon fa fa-angle-right"></i>
                    </a>
                </li>
            }
        </ul>
    }
}
else
{
    <div class="notfound">@_localizer["empty"]!</div>
}
